# Sahibinden Telegram Bot (Railway)

Sahibinden.com Ã¼zerindeki filtreleri takip edip yeni ilan dÃ¼ÅŸtÃ¼ÄŸÃ¼nde Telegram Ã¼zerinden bildirim gÃ¶nderen bot.

## ğŸ›  Kurulum

### 1. Supabase VeritabanÄ± HazÄ±rlÄ±ÄŸÄ±
Supabase panelinizdeki **SQL Editor** kÄ±smÄ±na gidip aÅŸaÄŸÄ±daki kodlarÄ± Ã§alÄ±ÅŸtÄ±rarak gerekli tablolarÄ± oluÅŸturun:

```sql
-- Filtreleri tutan tablo
create table filters (
  id bigint generated by default as identity primary key,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null,
  url text not null,
  telegram_id text not null,
  is_active boolean default true
);

-- GÃ¶rÃ¼lmÃ¼ÅŸ ilanlarÄ± tutan tablo
create table seen_ads (
  id bigint generated by default as identity primary key,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null,
  filter_id bigint references filters(id),
  ad_id text not null
);

-- Ä°ndeksler (Performans iÃ§in)
create index idx_seen_ads_lookup on seen_ads(filter_id, ad_id);
```

### 2. Veri Ekleme
Takip etmek istediÄŸiniz arama linkini `filters` tablosuna ekleyin:
```sql
insert into filters (url, telegram_id) values 
('https://www.sahibinden.com/otomobil/istanbul?sorting=date_desc', 'SENIN_TELEGRAM_ID');
```

### 3. Railway Deploy
Bu projeyi Railway'e deploy ederken ekstra bir ayar yapmanÄ±za gerek yok. `railway.json` dosyasÄ± gerekli `Playwright` tarayÄ±cÄ± kurulumlarÄ±nÄ± otomatik yapacaktÄ±r.

**Ortam DeÄŸiÅŸkenleri (Optional):**
Kod iÃ§inde API anahtarlarÄ± tanÄ±mlÄ± olsa da, gÃ¼venlik iÃ§in Railway "Variables" sekmesinde bunlarÄ± tanÄ±mlamanÄ±z Ã¶nerilir:
- `TELEGRAM_TOKEN`
- `SUPABASE_URL`
- `SUPABASE_SERVICE_ROLE_KEY`

### Ã‡alÄ±ÅŸma MantÄ±ÄŸÄ±
- Bot her 10 saniyede bir Ã§alÄ±ÅŸÄ±r.
- `filters` tablosundaki aktif kayÄ±tlarÄ± Ã§eker.
- `playwright` tarayÄ±cÄ±sÄ± ile linke gider.
- Ä°lanlarÄ± `seen_ads` tablosuyla karÅŸÄ±laÅŸtÄ±rÄ±r.
- Yeni ilan varsa Telegram'dan fotoÄŸraf ve detay gÃ¶nderir.
